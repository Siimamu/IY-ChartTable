<!DOCTYPE html>
<html lang="ja">

<head>
    <title>IBARAGI_YOSHIMI ChartTable</title>
    <link rel="icon" href="favicon.ico" sizes="128x128">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="bmstable" content="header.json" />
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous">
    </script>
</head>

<body>
    <style>
        table {
  width: 100%;
  border-collapse: collapse; /* 枠線の隙間をなくす */
  background-color: #000000; /* 表の背景を黒に */
  color: #ffffff;           /* 文字を白に */
}
  body {
    background-color: #121212; /* 背景を黒に */
  }
td {
  padding: 10px;
  text-align: center;
}
        th {
  padding: 12px;
  text-align: center;      /* 左右の中央揃え */
  vertical-align: middle;  /* 上下の中央揃え（セルに高さがある場合） */
}
/* Bootstrapのデフォルトホバー色を上書き */
#table_int tbody tr:hover td {
    background-color: #1a1a1a !important; /* 背景も少し明るく */
    color: #00ff00 !important;           /* 文字色をネオンブルーに */
    
    /* 上下の境界線に光の筋を入れる */
    border-top: 1px solid #00ff00 !important;
    border-bottom: 1px solid #00ff00 !important;
    
    /* 外側にボワーっと光る影をつける（これがネオンの正体） */
    text-shadow: inset 0 0 10px #00ff00, 0 0 10px #00ff00;
    
    /* 滑らかに光らせるための時間設定 */
    transition: all 0.2s ease;
}
/* リンクがある場合、リンクの色もホバー時に合わせる */
#table_int tbody tr:hover a {
    color: #00ff00 !important;
    text-shadow: 0 0 5px #00ff00;
}
        /* alert-info というクラスがついている要素をカスタマイズ */
.alert-success {
    background-color: #000000 !important; /* 背景を真っ黒に */
    color: #ffffff !important;
}
</style>
    <header class="mb-3">
        <nav class="navbar navbar-dark bg-dark">
            <div class="container-fluid">
                <span class="navbar-brand mb-0 h1">IBARAGI_YOSHIMI ChartTable</span>
            </div>
        </nav>
    </header>

    <div class="container">

        <div class="alert alert-success mb-3" role="alert">
            <p>obj:IBARAGI_YOSHIMI(別名義含む)の自作差分置き場 普通の地力譜面多め</p>
            <p>現在 <strong id="music-count">--</strong> 譜面あります</p>
            <p>何かあれば<a href="https://x.com/SiiM4Mu">@SiiM4Mu</a>まで</p>
            <hr>
            <p class="mb-0">難易度表記はstella基準です / IY0=st0</p>
            <p><a href="https://drive.google.com/drive/folders/16OQ6qU4EeQhNao3sRclAxkNxxVs-QcrP">差分まとめ(Google Drive)</a></p>
            <p><a href="https://drive.google.com/uc?export=download&id=1ds0Vy0FZcLHfwgTNE58_Z5a20Z1lFy-c">IY_ChartDAN(IY4~10)</a> <a href="https://drive.google.com/uc?export=download&id=1Xjt1jkBLP_cyvYAhOR9H58a6PdTqyNhg">IY_ChartDAN Season2(IY0~12)</a></p>
        </div>


        <!--ここから難易度表本体-->
        <div>
            <table class="table table-dark table-hover table-sm" id="table_int">
            </table>
        </div>
        <script language="javascript" type="text/javascript">
            $(document).ready(function () {
                $.getJSON($("meta[name=bmstable]").attr("content"), function (header) {
                    $.getJSON(header.data_url, function (information) {
                        makeBMSTable(information, header.symbol);
                    });
                });
            });

            function makeBMSTable(info, mark) {
                var x = "";
                var ev = "";
                var count = 0;
                var obj = $("#table_int");

                obj.html("");
                $("<thead class='table-dark'><tr><th>Level</th><th>Title</th><th>Artist</th><th>Chart</th><th>BPM</th><th>T/N</th><th>Comment</th></tr></thead><tbody>")
                    .appendTo(obj);
                var obj_sep = null;
                for (var i = 0; i < info.length; i++) {
                    if (x != info[i].level) {
                        if (obj_sep != null) {
                        }
                        obj_sep = $("<tr class='table-dark' style='text-align:center' id='" + mark + info[i].level +
                            "'></tr>");
                        obj_sep.appendTo(obj);
                        count = 0;
                        x = info[i].level;
                    }
                    var str = $("<tr></tr>");

                    // Level
                    $("<td width='3%'>" + mark + x + "</td>").appendTo(str);

                    // Title
                    $("<td width='25%'>" +
                        "<a href='http://www.dream-pro.info/~lavalse/LR2IR/search.cgi?mode=ranking&bmsmd5=" + info[
                            i]
                        .md5 + "' target='_blank'>" + info[i].title + "</a></td>").appendTo(str);

                    // Artist
                    $("<td width='15%'>" + info[i].artist + "</td>").appendTo(str);

                     // Chart
                    if (info[i].url_diff != "" && info[i].url_diff != null) {
                        if (info[i].name_diff != "" && info[i].name_diff != null) {
                            $("<td width='3%'><a href='" + info[i].url_diff + "'>" + info[i].name_diff + "</a></td>").appendTo(str);
                        } else {
                            $("<td width='3%'><a href='" + info[i].url_diff + "'>" + info[i].url_diff + "</a></td>").appendTo(str);
                        }
                    } else {
                        if (info[i].name_diff != "" && info[i].name_diff != null) {
                            $("<td width='3%'>" + info[i].name_diff + "</td>").appendTo(str);
                        } else {
                            $("<td width='3%'></td>").appendTo(str);
                        }
                    }

                    // BPM
                    $("<td width='3%'>" + info[i].bpm + "</td>").appendTo(str);

                    // T/N
                    $("<td width='3%'>" + info[i].tn + "</td>").appendTo(str);
                    
                    // Comment
                    $("<td width='15%'>" + info[i].comment + "</td>").appendTo(str);
                    str.appendTo(obj);
                    count++;

                }
            }
        </script>
    </div>
<script>
  $(window).on('load', function() {
    // 0.5秒ごとに、テーブルの中にデータが入ったかチェックする
    var checkExist = setInterval(function() {
      // 難易度表（#table_int）の中にある「行（tr）」の数を数える
      var rowCount = $('#table_int tr').length;

      // 行数が1より多い（＝ヘッダー以外のデータが入った）場合
      if (rowCount > 1) { 
        var musicCount = rowCount - 1; // 全行数から見出しの1行を引く
        
        // id="music-count" の場所に数字を書き込む
        $('#music-count').text(musicCount);
        
        // カウントが終わったので、チェック（監視）を止める
        clearInterval(checkExist);
      }
    }, 500); 
  });
</script>
